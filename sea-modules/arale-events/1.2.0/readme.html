<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>imagic - Events</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="nico 0.5.1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link type="image/x-icon" href="/favicon.ico" rel="icon">
    <link rel="stylesheet" href="../../../static/css/normalize.css" />
    <link rel="stylesheet" href="../../../static/css/site.css" />
    <link rel="stylesheet" href="../../../static/css/solarized.css" />
<script>
if (!location.port) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-50522089-2', 'auto');
  ga('send', 'pageview');
}
</script>

<script src="http://static.alipayobjects.com/seajs/seajs/2.2.0/sea.js"></script>

<script>
  seajs.config({
    base: "../../../",
    paths: {
      'jquery': 'http://static.alipayobjects.com/jquery'
    },
    alias: {"arale-events":"spm_modules/arale-events/1.2.0/events.js","expect.js":"spm_modules/expect.js/0.3.1/index.js"}
  });
</script>
    <!--[if lt IE 9]>
    <script src="../../../static/js/html5shiv.js"></script>
    <![endif]-->
  </head>
  <body class="spmjs">
    <div class="body-wrapper">
      <aside class="sidebar-wrapper">
      <h1>
          <a href="../../../">Imagic</a>
      </h1>
      <p class="sidebar-version">Version: <a href="http://spmjs.io/package/imagic" title="">1.3.0</a></p>
        <p class="sidebar-description" data-keyword="Image">Imagic send data by image, for tests mock.</p>
        <a class="sidebar-source" href="http:////github.com/hotoo/imagic" target="_blank">View the Project</a>
        <ul class="sidebar-navigation" role="navigation">
          <li><a href="../../../">Doc</a></li>
          <li><a href="../../../examples/">Demo</a></li>
          <li><a class="test-link" href="../../../tests/runner.html" target="_blank">Test</a></li>
          <li><a class="issue-link" href="http:////github.com/hotoo/imagic/issues" target="_blank">Issues</a></li>
        </ul>
        
<ol class="sidenav">
  <li><a href="HISTORY.html">History</a></li>
  <li><a href="README.html">Events</a></li>
</ol>

      </aside>
      <div class="content-wrapper">
        
<article class="hentry">
  <h1 class="entry-title">Events</h1>
  <div class="entry-content">
    <p><a href="http://spmjs.io/package/arale-events"><img src="http://spmjs.io/badge/arale-events" alt="spm package"></a>
<a href="https://travis-ci.org/aralejs/events"><img src="https://travis-ci.org/aralejs/events.png" alt="Build Status"></a>
<a href="https://coveralls.io/r/aralejs/events"><img src="https://coveralls.io/repos/aralejs/events/badge.png?branch=master" alt="Coverage Status"></a></p>
<p>提供基本的事件添加、移除和触发功能。</p>
<hr>
<h2 id="使用说明">使用说明<a href="#使用说明" class="anchor">¶</a></h2><p>使用 <code>Events</code> 有两种方式，一种是直接实例化：</p>
<pre>define(function(require) {
    var Events = require(&#39;events&#39;);

    var object = new Events();
    object.on(&#39;expand&#39;, function() {
        alert(&#39;expanded&#39;);
    });

    object.trigger(&#39;expand&#39;);
});</pre><p>另一种是将 <code>Events</code> 混入（mix-in）到其他类中：</p>
<pre>define(function(require) {
    var Events = require(&#39;events&#39;);

    function Dog() {
    }
    Events.mixTo(Dog);

    Dog.prototype.sleep = function() {
        this.trigger(&#39;sleep&#39;);
    };

    var dog = new Dog();
    dog.on(&#39;sleep&#39;, function() {
        alert(&#39;狗狗睡得好香呀&#39;);
    });

    dog.sleep();
});</pre><p>上面的例子已经展现了 <code>on</code>, <code>trigger</code> <code>mixTo</code> 等方法的基本用法，下面详细阐述所有 API 。</p>
<h3 id="on-object-on-event-callback-context">on <code>object.on(event, callback, [context])</code><a href="#on-object-on-event-callback-context" class="anchor">¶</a></h3><p>给对象添加事件回调函数。</p>
<p>可以传入第三个参数 <code>context</code> 来改变回调函数调用时的 <code>this</code> 值：</p>
<pre>post.on(&#39;saved&#39;, callback, that);</pre><p><strong>注意</strong>：<code>event</code> 参数有个特殊取值：<code>all</code> 对象上触发任何事件，都会触发 <code>all</code>
事件的回调函数，传给 <code>all</code> 事件回调函数的第一个参数是事件名。例如，下面的代码可以将一个对象上的所有事件代理到另一个对象上：</p>
<pre>proxy.on(&#39;all&#39;, function(eventName) {
    object.trigger(eventName);
});</pre><h3 id="off-object-off-event-callback-context">off <code>object.off([event], [callback], [context])</code><a href="#off-object-off-event-callback-context" class="anchor">¶</a></h3><p>从对象上移除事件回调函数。三个参数都是可选的，当省略某个参数时，表示取该参数的所有值。例子：</p>
<pre>// 移除 change 事件上名为 onChange 的回调函数
object.off(&#39;change&#39;, onChange);

// 移除 change 事件的所有回调函数
object.off(&#39;change&#39;);

// 移除所有事件上名为 onChange 的回调函数
object.off(null, onChange);

// 移除上下文为 context 的所有事件的所有回调函数
object.off(null, null, context);

// 移除 object 对象上所有事件的所有回调函数
object.off();</pre><h3 id="trigger-emit-object-trigger-event-args">trigger/emit <code>object.trigger(event, [*args])</code><a href="#trigger-emit-object-trigger-event-args" class="anchor">¶</a></h3><p>触发一个或多个事件（用空格分隔）。<code>*args</code> 参数会依次传给回调函数。</p>
<pre>obj.on(&#39;event&#39;, function(arg1, arg2) {
  // your code
});

obj.trigger(&#39;event&#39;, arg1, arg2);</pre><p>trigger 的返回值是一个布尔值，会根据所有 callback 的执行情况返回。只要有一个 callback 返回 false，trigger 就会返回 false。</p>
<pre>obj.on(&#39;event&#39;, function() {
  // do sth.
});
obj.on(&#39;event&#39;, function() {
  // do sth.
  return false;
});
obj.on(&#39;event&#39;, function() {
  // do sth
});

obj.trigger(&#39;event&#39;); // return false</pre><p><strong>注意</strong>：<code>on</code> 和 <code>off</code> 的 <code>event</code> 参数也可以表示多个事件（用空格分隔），比如：</p>
<pre>var obj = new Events();

obj.on(&#39;x y&#39;, fn);

// 等价：
obj.on(&#39;x&#39;).on(&#39;y&#39;);</pre><h3 id="mixto-events-mixto-receiver">mixTo <code>Events.mixTo(receiver)</code><a href="#mixto-events-mixto-receiver" class="anchor">¶</a></h3><p>将 <code>Events</code> 的原型方法混入到指定对象或函数原型中。</p>
<h2 id="问题讨论">问题讨论<a href="#问题讨论" class="anchor">¶</a></h2><ul>
<li>handler 的异常处理 <a href="https://github.com/aralejs/events/issues/1">https://github.com/aralejs/events/issues/1</a></li>
</ul>
<h2 id="性能对比">性能对比<a href="#性能对比" class="anchor">¶</a></h2><ul>
<li><a href="http://jsperf.com/events-perfs/6">http://jsperf.com/events-perfs/6</a></li>
</ul>
<p><strong>注</strong>：最开始，该模块的主要代码直接来自 Backbone.Events. 后来发现 Backbone
的代码实现有较大的改进空间，因此将内部的数据结构从链表改成了数组，重构后大幅度提升了性能。目前
Backbone 已合并 Arale 的代码：</p>
<ul>
<li><a href="https://github.com/documentcloud/backbone/pull/1284">https://github.com/documentcloud/backbone/pull/1284</a></li>
</ul>

  </div>
</article>

      </div>
      
    </div>
    <div class="footer-wrapper">
      <footer>
        <p class="footer-powered"><a href="http://spmjs.io">spmjs.io</a> •
<a href="https://github.com/spmjs/spm">spm</a> •
<a href="http://seajs.org">Sea.js</a> •
<a href="http://lab.lepture.com/nico/">nico</a>
        </p>
      </footer>
    </div>
  </body>
  <script src="../../../static/js/nprogress.js?nowrap"></script>
  <script>
  (function() {
    NProgress.start();
    window.onload = NProgress.done;
    var ready = function(fn) {
      var doc = document;
      if(doc.addEventListener) {
        doc.addEventListener('DOMContentLoaded', fn, false);
      } else {
        doc.attachEvent('onreadystatechange', fn);
      }
    };
    ready(function() {
      NProgress.inc(0.6);
    }, false);
  })();
  </script>
</html>